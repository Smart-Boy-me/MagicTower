//玩家数据
var player = {
    att: 10,            //攻击
    def: 10,            //防御
    hp: 500,           //血量
    coin: 0,            //金币
    level: 1,           //等级
    exp: 1,             //经验
    yellowKey: 0,       //黄钥匙
    blueKey: 0,         //蓝钥匙
    redKey: 0,          //红钥匙
    sword: 0,           //是否拿到铁剑
    shield:0,           //是否拿到铁盾
    handbook: 0,        //是否拿到怪物手册
    floor: 1,          //所处的楼层
    isTalking: 0,       //是否正在谈话
    isTalkingToTrader: 0, //是否正在和商人谈话
    isBuying: 0,        //是否正在上商店购买物品
    isLookingBook: 0,   //是否正在查看怪物手册
    isLookingHelp: 0,   //是否正在查看帮助
    buyTimes: 1,        //在商店购买的次数，初始值为1
    hearing: "",        //玩家在此次谈话时听到的话
    x: 6,//1~11         //玩家x坐标
    y: 11,//1~11        //玩家y坐标
    face: 4             //玩家面朝向：1下2左3右4上
};

//地图信息
var data = [//每一层的地图数据：建筑(1-8)、人物(9-20)、道具(21-30)
            // case 1 :  //    墙
            // case 2 :  //    牢门
            // case 3 :  //    下楼梯
            // case 4 :  //    上楼梯
            // case 5 :  //    黄门
            // case 6 :  //    蓝门
            // case 7 :  //    红门
            // case 8 :  //    自动门
            // case 9 :  //    骷髅人
            // case 10 : //    骷髅士兵
            // case 11 : //    骷髅队长
            // case 12 : //    小蝙蝠
            // case 13 : //    绿史莱姆
            // case 14 : //    红史莱姆
            // case 15 : //    初级法师
            // case 16 : //    初级卫兵
            // case 17 : //    中级卫兵
            // case 18 : //    智慧老人
            // case 19 : //    商人
            // case 20 : //    商店
            // case 21 : //    红宝石
            // case 22 : //    蓝宝石
            // case 23 : //    红药水
            // case 24 : //    蓝药水
            // case 25 : //    黄钥匙
            // case 26 : //    蓝钥匙
            // case 27 : //    记事本
            // case 28 : //    铁剑
            // case 29 : //    铁盾
            // case 30 : //    楼层传送器
            // case 31 : //    红钥匙
    [ //0
        4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [ //1
        4, 0, 13, 14, 13, 0, 0, 0, 0, 0, 0,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
        23, 0, 0, 5, 0, 1, 21, 25, 0, 1, 0,
        0, 9, 0, 1, 0, 1, 22, 25, 0, 1, 0,
        1, 5, 1, 1, 0, 1, 1, 1, 5, 1, 0,
        0, 0, 0, 1, 0, 5, 12, 15, 12, 1, 0,
        0, 10, 0, 1, 0, 1, 1, 1, 1, 1, 0,
        1, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 5, 1, 1, 1, 5, 1,
        23, 0, 25, 1, 25, 0, 18, 1, 0, 12, 0,
        23, 30, 25, 1, 0, 0, 0, 1, 13, 24, 13,
    ],
    [ //2
        3, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 1, 1, 0, 17, 0, 17, 0, 1, 1,
        0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,
        0, 1, 25, 25, 1, 0, 0, 0, 1, 0, 18,
        0, 1, 25, 0, 2, 0, 0, 0, 2, 0, 0,
        0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1,
        0, 1, 22, 22, 1, 0, 0, 0, 1, 0, 19,
        0, 1, 21, 21, 2, 0, 0, 0, 2, 0, 0,
        0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1,
        0, 1, 24, 24, 1, 0, 0, 0, 1, 0, 0,
        4, 1, 24, 0, 2, 0, 0, 0, 2, 0, 0,
    ],
    [ //3
        25, 22, 1, 25, 24, 25, 1, 0, 1, 0, 23,
        0, 23, 1, 24, 25, 24, 1, 0, 5, 12, 0,
        15, 0, 1, 25, 26, 25, 1, 0, 1, 1, 1,
        5, 1, 1, 1, 0, 1, 1, 0, 1, 0, 18,
        0, 0, 12, 0, 0, 0, 13, 0, 0, 0, 0,
        5, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1,
        9, 0, 1, 1, 0, 1, 1, 0, 1, 0, 23,
        0, 25, 1, 0, 0, 0, 1, 0, 5, 15, 25,
        23, 21, 1, 0, 0, 0, 1, 0, 1, 1, 1,
        1, 1, 1, 1, 0, 1, 1, 14, 1, 0, 0,
        3, 0, 0, 0, 0, 0, 1, 0, 5, 0, 4,
    ],
    [ //4
        0, 26, 0, 1, 0, 20, 0, 1, 0, 18, 0,
        23, 0, 25, 1, 0, 0, 0, 1, 25, 0, 24,
        0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 0,
        1, 5, 1, 1, 1, 6, 1, 1, 1, 5, 1,
        0, 15, 0, 5, 0, 0, 0, 0, 9, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        14, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0,
        5, 1, 1, 5, 1, 1, 1, 5, 1, 1, 5,
        0, 1, 0, 12, 0, 1, 0, 15, 0, 1, 0,
        0, 1, 13, 0, 25, 1, 21, 0, 23, 1, 0,
        4, 1, 25, 13, 25, 1, 0, 13, 0, 1, 3,
    ],
    [ //5
        4, 1, 0, 14, 5, 0, 1, 0, 0, 5, 0,
        0, 1, 0, 0, 1, 25, 1, 13, 13, 1, 14,
        0, 5, 12, 0, 1, 0, 1, 25, 25, 1, 0,
        1, 1, 5, 1, 1, 12, 1, 25, 25, 1, 0,
        25, 0, 15, 0, 1, 0, 1, 1, 1, 1, 0,
        25, 0, 0, 12, 1, 0, 13, 0, 0, 0, 0,
        1, 10, 1, 1, 1, 0, 1, 1, 1, 1, 14,
        0, 0, 0, 0, 1, 13, 1, 0, 0, 0, 0,
        22, 25, 23, 27, 1, 0, 1, 5, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0,
        3, 0, 0, 0, 0, 0, 1, 0, 0, 0, 28,
    ],
    [ //6
        3, 1, 25, 25, 1, 0, 15, 0, 25, 13, 0,
        0, 1, 25, 25, 1, 0, 1, 1, 1, 1, 5,
        0, 1, 0, 14, 1, 0, 1, 23, 0, 9, 0,
        0, 5, 5, 0, 5, 0, 1, 19, 0, 0, 12,
        0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,
        0, 0, 14, 15, 0, 25, 0, 9, 10, 0, 0,
        1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0,
        15, 0, 0, 18, 1, 0, 5, 5, 0, 5, 0,
        0, 12, 0, 22, 1, 0, 1, 1, 14, 1, 14,
        5, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0,
        0, 13, 0, 0, 9, 0, 1, 23, 23, 1, 4,
    ],
    [ //7
        4, 1, 21, 1, 19, 0, 18, 1, 25, 1, 13,
        0, 1, 23, 1, 0, 0, 0, 1, 25, 1, 13,
        0, 1, 12, 1, 14, 1, 10, 1, 23, 1, 14,
        0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
        5, 1, 5, 1, 6, 1, 5, 1, 9, 1, 5,
        0, 10, 0, 15, 0, 0, 0, 0, 0, 0, 0,
        5, 1, 5, 1, 5, 1, 5, 1, 10, 1, 5,
        0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
        0, 1, 0, 1, 12, 1, 14, 1, 24, 1, 0,
        13, 1, 13, 1, 25, 1, 15, 1, 25, 1, 0,
        0, 14, 0, 1, 25, 1, 24, 1, 25, 1, 3,
    ],
    [ //8
        3, 0, 5, 5, 0, 4, 0, 1, 25, 0, 25,
        0, 0, 1, 1, 0, 0, 13, 1, 0, 31, 0,
        5, 1, 1, 1, 1, 5, 1, 1, 24, 0, 23,
        0, 1, 25, 25, 25, 0, 0, 1, 1, 8, 1,
        23, 1, 1, 1, 1, 1, 15, 1, 16, 0, 16,
        0, 14, 13, 14, 0, 1, 0, 1, 0, 0, 0,
        1, 1, 1, 1, 5, 1, 12, 1, 1, 5, 1,
        0, 0, 0, 12, 0, 9, 0, 15, 0, 0, 0,
        5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5,
        13, 0, 1, 21, 25, 1, 26, 23, 1, 0, 9,
        0, 12, 6, 25, 22, 1, 25, 0, 5, 10, 0,
    ],
    [ //9
        0, 0, 9, 5, 0, 3, 0, 5, 13, 0, 23,
        0, 25, 0, 1, 0, 0, 0, 1, 0, 13, 0,
        10, 1, 1, 1, 1, 6, 1, 1, 1, 1, 0,
        0, 25, 0, 1, 25, 0, 25, 5, 5, 0, 18,
        22, 0, 12, 5, 0, 21, 0, 1, 1, 0, 1,
        1, 1, 1, 1, 1, 1, 14, 1, 0, 0, 10,
        25, 0, 5, 10, 25, 1, 0, 1, 29, 1, 0,
        10, 0, 1, 0, 0, 1, 0, 1, 1, 1, 5,
        5, 1, 1, 1, 5, 1, 0, 1, 25, 0, 15,
        0, 23, 1, 0, 9, 1, 12, 1, 0, 9, 0,
        4, 0, 6, 0, 0, 5, 0, 5, 15, 0, 23,
    ],
    [ //10
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1,
        9, 9, 9, 1, 1, 0, 1, 1, 9, 9, 9,
        0, 10, 0, 8, 0, 11, 0, 8, 0, 10, 0,
        1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1,
        9, 22, 9, 1, 0, 0, 0, 1, 9, 21, 9,
        0, 10, 0, 1, 1, 0, 1, 1, 0, 10, 0,
        0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0,
        5, 1, 5, 1, 1, 7, 1, 1, 5, 1, 5,
        0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,
        3, 1, 0, 15, 0, 0, 0, 15, 0, 1, 24,
    ]
];

//NPC对话信息
var NPC_Wiser_Word = [
    //每层智慧老人的话
    "",
    "勇士，我怎么会在这看到您？我也不知道怎么来到此处？我也不知道该怎么出去？我只知道铁剑在5楼，铁盾在9楼，你最好先取到它们。",
    "谢谢你救了我，为感谢你的帮助，我将把你的攻击力和防御力各加10%。",
    "送你一本怪物书，它能预测出当前楼层各类怪物对你的伤害。",
    "有些门不能用钥匙打开，只有当你打败它的守卫后才会自动打开。",
    "记事本系统已开启，记事本将自动记录所有重要的谈话与提示。",
    "魔塔一共50层，每10层为一个区域。如果不打败此区域的头目就不能到更高的地方。",
    "在商店里你最好选择提升防御，只有在攻击力低于敌人的防御力时才提升攻击力。",
    "",
    "你是否注意到 5,9,14,16,18 楼有的墙与众不同？",
    ""
];

var NPC_Trader_Word = [
    //每层商人的话
    "",
    "",
    "谢谢你救了我，为感谢你的帮助，我送给你100金币。",
    "",
    "",
    "",
    "我有1把蓝钥匙，你出50个金币就卖给你。",
    "我有5把黄钥匙，你出50个金币就卖给你。",//7
    "",
    "",
    "",
]

//怪物信息

var m9 = {//骷髅人
    name:"骷髅人",
    id:9,
    hp:150,
    att:20,
    def:6,
    coin:6,
    exp:2
};

var m10 = {//骷髅士兵
    name:"骷髅士兵",
    id:10,
    hp:230,
    att:23,
    def:8,
    coin:8,
    exp:3
};

var m11= {//骷髅队长
    name:"骷髅队长",
    id:11,
    hp:600,
    att:45,
    def:20,
    coin:30,
    exp:100
};

var m12 = {//小蝙蝠
    name:"小蝙蝠",
    id:12,
    hp:100,
    att:15,
    def:5,
    coin:3,
    exp:1
};

var m13 = {//绿史莱姆
    name:"绿史莱姆",
    id:13,
    hp:25,
    att:12,
    def:1,
    coin:1,
    exp:1
};

var m14 = {//红史莱姆
    name:"红史莱姆",
    id:15,
    hp:75,
    att:13,
    def:2,
    coin:2,
    exp:1
};

var m15 = {//初级法师
    name:"初级法师",
    id:15,
    hp:150,
    att:25,
    def:6,
    coin:5,
    exp:2
};

var m16 = {//初级卫兵
    name:"初级卫兵",
    id:16,
    hp:275,
    att:30,
    def:17,
    coin:10,
    exp:4
};

var m17 = {//中级卫兵
    name:"中级卫兵",
    id:17,
    hp:400,
    att:35,
    def:25,
    coin:20,
    exp:7
};

//怪物集合
var monster_set = [
    null,null,null,null,null,null,null,null,null,
    m9, m10, m11, m12, m13, m14, m15, m16, m17
];